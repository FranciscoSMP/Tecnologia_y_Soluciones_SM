<section class="mt-5">
    <h3>Editar Usuario</h3>

    <!-- Mensajes de error o éxito -->
    {{#if success_msg}}
        <div class="alert alert-success mt-3">{{success_msg}}</div>
    {{/if}}
    {{#if error_msg}}
        <div class="alert alert-danger mt-3">{{error_msg}}</div>
    {{/if}}

    <form action="/usuario/actualizar/{{usuario.Id_Usuario}}" method="POST" class="mt-3" id="formAgregarUsuario">

        <div class="row">
            <div class="col-md-6">
                <label>Nombre de Usuario</label>
                <input type="text" name="nombre_usuario" value="{{usuario.Nombre_Usuario}}" class="form-control" required>
            </div>
            <div class="col-md-6">
                <label>Correo Electrónico</label>
                <input type="email" name="correo_electronico" value="{{usuario.Correo_Electronico}}" class="form-control">
            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-3">
                <label>Primer Nombre</label>
                <input type="text" name="primer_nombre" value="{{usuario.Primer_Nombre}}" class="form-control" required>
            </div>
            <div class="col-md-3">
                <label>Segundo Nombre</label>
                <input type="text" name="segundo_nombre" value="{{usuario.Segundo_Nombre}}" class="form-control">
            </div>
            <div class="col-md-3">
                <label>Primer Apellido</label>
                <input type="text" name="primer_apellido" value="{{usuario.Primer_Apellido}}" class="form-control" required>
            </div>
            <div class="col-md-3">
                <label>Segundo Apellido</label>
                <input type="text" name="segundo_apellido" value="{{usuario.Segundo_Apellido}}" class="form-control">
            </div>
        </div>

        <!-- 🔐 Campos de contraseña opcional -->
        <div class="row mt-3">
            <div class="col-md-6">
                <label>Nueva Contraseña (opcional)</label>
                <input type="password" id="contrasenia" name="contrasenia" class="form-control" placeholder="Dejar vacío para no cambiar">
            </div>
            <div class="col-md-6">
                <label>Confirmar Nueva Contraseña</label>
                <input type="password" id="confirmar_contrasenia" name="confirmar_contrasenia" class="form-control" placeholder="Repetir nueva contraseña">
                
                <!-- Mensaje de error si las contraseñas no coinciden -->
                <div id="mensajeError" class="text-danger mt-2" style="display:none;">
                    Las contraseñas no coinciden.
                </div>
            </div>
        </div>

        <div class="row mt-3">
            <div class="col-md-6">
                <label>Rol</label>
                <select name="id_rol" class="form-select" required>
                    {{#each roles}}
                        <option value="{{this.Id_Rol}}" {{#ifCond this.Id_Rol '==' ../usuario.Id_Rol}}selected{{/ifCond}}>
                            {{this.Rol}}
                        </option>
                    {{/each}}
                </select>
            </div>
        </div>

        <div class="mt-4">
            <button type="submit" class="btn btn-primary">💾 Guardar Cambios</button>
            <a href="/usuario/table" class="btn btn-secondary ms-2">Cancelar</a>
        </div>
    </form>
</section>
